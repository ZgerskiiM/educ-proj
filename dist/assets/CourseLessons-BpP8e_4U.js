import{A as M}from"./Header-BBPRn6se.js";import{d as F,u as N,r as d,o as u,q as V,w,a as o,b as a,t as l,f as I,_ as j,h as T,g as t,i as k,G as O,c as b,e as J,m as S,F as K,k as Q,y as X,l as Y}from"./index-BAaSDoqS.js";import{c as U}from"./courseUserService-CQM62zTH.js";import{A as Z}from"./AppFooter-Cgy3zGr0.js";const ee={class:"pa-4"},se={class:"card-text d-flex flex-wrap"},te={class:"font-weight-bold mr-1"},oe={class:"font-weight-light"},ae=F({__name:"LessonCard",props:{courseData:{type:Object,required:!0}},emits:["click"],setup(v){const{mdAndDown:m}=N();return(c,_)=>{const r=d("v-img"),f=d("v-card");return u(),V(f,{onClick:_[0]||(_[0]=x=>c.$emit("click",v.courseData.id)),class:"course-lessons rounded-lg",width:I(m)?"50vw":"20vw",elevation:"1"},{default:w(()=>[o(r,{src:v.courseData.imagePath,class:"responsive-image mr-3 ml-3 mt-3 rounded-lg","aspect-ratio":16/9,cover:""},null,8,["src"]),a("div",ee,[a("div",se,[a("span",te,l(v.courseData.number)+" /",1),a("span",oe,l(v.courseData.title),1)])])]),_:1},8,["width"])}}}),ce=j(ae,[["__scopeId","data-v-389e250b"]]),re={class:"page-wrapper"},ne={class:"info"},le={class:"mt-5 font-weight-medium"},ie={class:"mb-2 font-weight-regular"},ue={class:"back-button-container ga-3 mt-4 mb-5"},de={key:0,class:"text-center w-100"},ve={key:1,class:"text-center w-100 red--text"},me=F({__name:"CourseLessons",setup(v){const{mdAndDown:m}=N(),c=X(),_=Y(),r=T(()=>c.params.courseId),f=T(()=>c.params.blocksId),x=t(""),C=t([]),q=t("Авторский курс от Максима Бабича"),P=t("1"),$=t(""),n=t(!0),i=t(""),D=t([]),B=t("");k(()=>{const e=localStorage.getItem(`original_course_image_${r.value}`);e&&(B.value=e),A()});const A=async()=>{n.value=!0,i.value="";try{const e=await O(f.value);$.value=e.blockTitle,D.value=e.lessons;const s=localStorage.getItem(`original_course_image_${r.value}`);s&&(B.value=s)}catch(e){i.value="Не удалось загрузить данные уроков",console.error(e)}finally{n.value=!1}},R=t(""),W=e=>{if(!e)return"/assets/default-lesson.jpg";let s=e.replace(/https:\/\/https:\/\//g,"https://");return s=s.replace(/https:\/\/https\//g,"https://"),s},z=async(e,s)=>{if(e){n.value=!0;try{const h=(await U.fetchCourseWithBlocks(e)).blocks.find(y=>y.blockId===s);h&&(R.value=W(h.imageUrl))}catch(g){console.error("Ошибка при загрузке данных:",g)}finally{n.value=!1}}};k(()=>{const e=c.params.courseId,s=c.params.blockId;e&&s&&z(e,s)});const E=async e=>{if(e){n.value=!0,i.value="";try{const s=await U.fetchCourseWithBlocks(e);x.value=s.courseTitle||"Курс без названия",C.value=s.blocks||[]}catch(s){console.error("Ошибка при загрузке курса:",s),i.value="Не удалось загрузить данные курса. Пожалуйста, попробуйте позже.",C.value=[]}finally{n.value=!1}}};k(()=>{const e=c.params.courseId;e&&(r.value=e,E(e))});const G=e=>{_.push(`/course/${r.value}/blocks/${f.value}/lessons/${e}`)};return k(()=>{A()}),(e,s)=>{const g=d("v-btn"),h=d("v-card-title"),y=d("v-progress-circular"),L=d("v-container");return u(),b("div",re,[o(M),o(L,{class:S(I(m)?"lessons-container":"lessons-container pl-0 pr-0"),width:I(m)?"100vw":"60vw"},{default:w(()=>[a("div",ne,[a("h2",le,l(x.value),1),a("h3",ie,l(q.value),1)]),a("div",ue,[o(g,{class:"text-none secondary-action-btn",variant:"outlined",color:"#313131",text:"Назад",to:`/course/${r.value}`},null,8,["to"])]),o(h,{class:"course-title font-weight-bold pt-0 pl-0",style:{color:"#333132"}},{default:w(()=>[J(" Блок "+l(P.value)+" / "+l($.value),1)]),_:1}),o(L,{class:S(I(m)?"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 mr-0 pr-0":"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 align-center")},{default:w(()=>[n.value?(u(),b("div",de,[o(y,{indeterminate:"",color:"#F48A21"})])):i.value?(u(),b("div",ve,l(i.value),1)):(u(!0),b(K,{key:2},Q(D.value,(p,H)=>(u(),V(ce,{key:p.lessonId,"course-data":{id:p.lessonId,number:String(H+1).padStart(2,"0"),title:p.lessonTitle,imagePath:p.imageUrl},onClick:pe=>G(p.lessonId)},null,8,["course-data","onClick"]))),128))]),_:1},8,["class"])]),_:1},8,["class","width"]),o(Z)])}}}),ke=j(me,[["__scopeId","data-v-d5e38577"]]);export{ke as default};
