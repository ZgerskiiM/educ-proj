import{d as N,u as U,r as v,a as b,b as j,o as x,c as R,e as l,w as u,f as q,g as f,h as g,i as P,t as T,j as z,k as F,n as G,l as M,m as d,A as w,_ as H}from"./index-DaAjR9Ux.js";import{A as J,_ as K}from"./AuthMobileImage.vue_vue_type_script_setup_true_lang-mt0ckWHy.js";const O={class:"page-container"},Q=N({__name:"LoginPage",setup(W){const{mdAndDown:k,smAndUp:_}=U(),m=M(),c=v(!1),p=v(!1),a=v(""),r=b({password:"",email:""}),n=b({password:"",email:""}),I=()=>{m.push("/register")},V=()=>{let s=!0;return r.email.trim()||(n.email="Введите email",s=!1),r.password||(n.password="Введите пароль",s=!1),s},h=s=>{try{return localStorage.getItem(s)}catch(e){return console.error("Error accessing localStorage:",e),null}},A=(s,e)=>{try{localStorage.setItem(s,e)}catch(t){console.error("Error writing to localStorage:",t)}},S=s=>{try{localStorage.removeItem(s)}catch(e){console.error("Error removing from localStorage:",e)}},C=async()=>{var s,e;if(V())try{p.value=!0,a.value="",n.email="",n.password="";const t=await w.login(r.email,r.password),o=h("redirectAfterLogin");S("redirectAfterLogin"),o?o.includes("/admin")&&!w.isAdmin()?(m.push("/lk"),A("accessError","Доступ к административной панели запрещен")):m.push(o):w.isAdmin()?m.push("/admin"):m.push("/course")}catch(t){if(t.response){if(t.response.status===401)a.value="Неверный логин или пароль";else if(t.response.status===403)a.value="Доступ запрещен";else if((s=t.response.data)!=null&&s.message)a.value=t.response.data.message;else if((e=t.response.data)!=null&&e.errors){const o=t.response.data.errors;o.email&&(n.email=o.email),o.password&&(n.password=o.password)}else a.value=`Ошибка сервера: ${t.response.status}`;console.error("Ошибка сервера:",t.response.data)}else t.request?(a.value="Не удалось связаться с сервером. Проверьте подключение к интернету.",console.error("Ошибка запроса:",t.request)):(a.value=`Произошла ошибка: ${t.message}`,console.error("Ошибка:",t.message))}finally{p.value=!1}},E=j(()=>!r.email||!r.password||p.value);return(s,e)=>{const t=d("v-card-title"),o=d("v-text-field"),$=d("router-link"),B=d("v-card-text"),D=d("v-alert"),y=d("v-btn"),L=d("v-container");return x(),R("div",O,[l(J),l(L,{class:"main-container"},{default:u(()=>[q("form",{onSubmit:F(C,["prevent"]),class:G(["align-md-center d-flex flex-column",g(k)?"w-66":"w-50"])},[l(K),l(t,{class:"align-md-center justify-center d-flex pl-0 mb-3 font-weight-regular"},{default:u(()=>e[7]||(e[7]=[f(" Вход ")])),_:1}),l(o,{class:"w-100 font-weight-light",modelValue:r.email,"onUpdate:modelValue":e[0]||(e[0]=i=>r.email=i),label:"Логин",variant:"outlined",density:g(_)?"comfortable":"compact","error-messages":n.email,onInput:e[1]||(e[1]=i=>n.email="")},null,8,["modelValue","density","error-messages"]),l(o,{class:"w-100 mb-0 font-weight-light",label:"Пароль",density:g(_)?"comfortable":"compact",variant:"outlined","append-inner-icon":c.value?"mdi-eye-off":"mdi-eye",modelValue:r.password,"onUpdate:modelValue":e[2]||(e[2]=i=>r.password=i),type:c.value?"text":"password","onClick:appendInner":e[3]||(e[3]=i=>c.value=!c.value),"error-messages":n.password,onInput:e[4]||(e[4]=i=>n.password="")},null,8,["density","append-inner-icon","modelValue","type","error-messages"]),l(B,{class:"w-100 justify-center d-flex mt-0 pt-0 pl-0 font-weight-light"},{default:u(()=>[e[9]||(e[9]=f(" Забыли пароль?   ")),l($,{to:"reset-password"},{default:u(()=>e[8]||(e[8]=[f(" Восстановить ")])),_:1})]),_:1}),a.value?(x(),P(D,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-3 w-100 font-weight-light","onClick:close":e[5]||(e[5]=i=>a.value="")},{default:u(()=>[f(T(a.value),1)]),_:1})):z("",!0),l(y,{class:"text-none mb-2 w-100 font-weight-thin",type:"submit",text:"Войти",loading:p.value,disabled:E.value,flat:""},null,8,["loading","disabled"]),l(y,{class:"text-none mb-2 w-100 font-weight-thin",text:"Создать аккаунт",onClick:e[6]||(e[6]=i=>I()),flat:""})],34)]),_:1})])}}}),Z=H(Q,[["__scopeId","data-v-e038522f"]]);export{Z as default};
