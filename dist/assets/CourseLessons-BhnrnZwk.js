import{H as q,A as G}from"./AppFooter-Dc1Yc8yi.js";import{d as E,u as N,c as k,m as d,o as n,i as A,w as _,e as o,f as r,t as a,b as f,n as P,j as H,h as C,_ as R,r as t,p as S,g as B,F as z,y as W,q as J,l as K,E as Q}from"./index-DnWPXEAX.js";import{c as X}from"./courseUserService-CT5bbBLw.js";const Y={class:"pa-4"},Z={class:"card-text d-flex flex-wrap"},ee={class:"font-weight-bold mr-1"},se={class:"font-weight-light"},te=E({__name:"LessonCard",props:{courseData:{type:Object,required:!0}},emits:["click"],setup(c){const{mdAndDown:g}=N(),l=c,x=k(()=>{switch(l.courseData.progress){case"IN_PROGRESS":return"В процессе";case"COMPLETED":return"Завершено";default:return"Не начато"}}),p=k(()=>{switch(l.courseData.progress){case"IN_PROGRESS":return"progress-in-progress";case"COMPLETED":return"progress-completed";default:return"progress-not-started"}});return(h,v)=>{const w=d("v-img"),y=d("v-card");return n(),A(y,{onClick:v[0]||(v[0]=D=>h.$emit("click",c.courseData.id)),class:"course-lessons rounded-lg",width:C(g)?"50vw":"20vw",elevation:"1"},{default:_(()=>[o(w,{src:c.courseData.imagePath,class:"responsive-image rounded-t","aspect-ratio":16/9,cover:""},null,8,["src"]),r("div",Y,[r("div",Z,[r("span",ee,a(c.courseData.number)+" /",1),r("span",se,a(c.courseData.title),1)]),c.courseData.progress?(n(),f("div",{key:0,class:P(["progress-badge mt-2",p.value])},a(x.value),3)):H("",!0)])]),_:1},8,["width"])}}}),oe=R(te,[["__scopeId","data-v-988132ed"]]),ae={class:"page-wrapper"},re={class:"info"},ce={class:"mt-5 font-weight-medium"},ne={class:"mb-2 font-weight-regular"},le={class:"back-button-container pt-4 pb-2 pl-0 ml-0"},ue={key:0,class:"text-center w-100"},ie={key:1,class:"text-center w-100 red--text"},de=E({__name:"CourseLessons",setup(c){const{mdAndDown:g}=N(),l=J(),x=K(),p=k(()=>l.params.courseId),h=k(()=>l.params.blocksId),v=t(""),w=t([]),y=t("Авторский курс от Максима Бабича"),D=t("1"),$=t(""),m=t(!0),u=t(""),I=t([]),T=e=>{if(!e)return"/public/default-lesson.jpg";let s=e.replace(/https:\/\/https:\/\//g,"https://");return s=s.replace(/https:\/\/https\//g,"https://"),s},O=async e=>{if(e){m.value=!0,u.value="";try{const s=await X.fetchCourseWithBlocks(e);v.value=s.courseTitle||"Курс без названия",w.value=s.blocks||[]}catch(s){console.error("Ошибка при загрузке курса:",s),u.value="Не удалось загрузить данные курса. Пожалуйста, попробуйте позже.",w.value=[]}finally{m.value=!1}}};S(()=>{const e=l.params.courseId;e&&(p.value=e,O(e))});const U=async()=>{m.value=!0,u.value="";try{const e=await Q(h.value);$.value=e.blockTitle,I.value=e.lessons}catch(e){u.value="Не удалось загрузить данные уроков",console.error(e)}finally{m.value=!1}},F=(e,s)=>{if(s){const b=T(s);console.log(`Сохраняем изображение урока ${e}:`,b),localStorage.setItem(`lesson_image_${e}`,b)}x.push(`/course/${p.value}/blocks/${h.value}/lessons/${e}`)};return S(()=>{U()}),(e,s)=>{const b=d("v-btn"),V=d("v-card-title"),j=d("v-progress-circular"),L=d("v-container");return n(),f("div",ae,[o(q),o(L,{width:C(g)?"100vw":"60vw"},{default:_(()=>[r("div",re,[r("h2",ce,a(v.value),1),r("h3",ne,a(y.value),1)]),r("div",le,[o(b,{variant:"outlined",density:"comfortable",to:`/course/${p.value}`,class:"back-button text-none"},{default:_(()=>s[0]||(s[0]=[B(" К блокам ")])),_:1},8,["to"])]),o(V,{class:"course-title font-weight-bold pt-0 pl-0",style:{color:"#333132"}},{default:_(()=>[B(" Блок "+a(D.value)+" / "+a($.value),1)]),_:1}),o(L,{class:P(C(g)?"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 mr-0 pr-0":"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 align-center")},{default:_(()=>[m.value?(n(),f("div",ue,[o(j,{indeterminate:"",color:"#F48A21"})])):u.value?(n(),f("div",ie,a(u.value),1)):(n(!0),f(z,{key:2},W(I.value,(i,M)=>(n(),A(oe,{key:i.lessonId,"course-data":{id:i.lessonId,number:String(M+1).padStart(2,"0"),title:i.lessonTitle,imagePath:T(i.imageUrl)},onClick:pe=>F(i.lessonId,i.imageUrl)},null,8,["course-data","onClick"]))),128))]),_:1},8,["class"])]),_:1},8,["width"]),o(G)])}}}),fe=R(de,[["__scopeId","data-v-f507f4bb"]]);export{fe as default};
