import{d as S,u as T,r as i,o as a,s as g,w as u,a as s,b as n,p as L,f as b,t as m,c as h,e as w,_ as U,g as c,D as P,i as z,v as k,F as R,l as H,m as M,z as O}from"./index-r6CkWk_M.js";import{c as W}from"./courseUserService-D92D7Kjw.js";import{A as G}from"./Header-Cn-_yNmi.js";import{A as J}from"./AppFooter-7TrP2N6X.js";const K={class:"d-flex align-center justify-space-between"},Q={class:"text-h7"},X={class:"font-weight-regular"},Y={class:"font-weight-light"},Z={key:0,class:"chip-container w-100 mt-2"},ee={key:1,class:"chip d-flex flex-wrap gap-2 mt-2"},te=S({__name:"CourseCard",props:{courseData:{type:Object,required:!0,default:()=>({id:0,number:"1",title:"Загрузка...",imagePath:"/public/placeholder.jpg",progress:{completed:0,total:0},duration:"0 часов",lessons:0,cards:0})}},emits:["click"],setup(l){const{mdAndDown:p}=T();return(C,f)=>{const d=i("v-img"),o=i("v-chip"),_=i("v-card");return a(),g(_,{onClick:f[0]||(f[0]=v=>C.$emit("click",l.courseData.id)),class:L(b(p)?"course-block-card d-flex flex-column rounded-lg":"rounded-lg	 course-block-card d-flex align-center"),width:"100%",flat:"",elevation:"1"},{default:u(()=>[s(d,{src:l.courseData.imagePath,class:"responsive-image rounded-t","aspect-ratio":16/9,cover:""},null,8,["src"]),n("div",{class:L(b(p)?"card-text px-2 py-3 flex-grow-1":"card-text ml-10 flex-grow-1")},[n("div",K,[n("div",Q,[n("span",X,"Блок "+m(l.courseData.number)+" / ",1),n("span",Y,m(l.courseData.title),1)])]),b(p)?(a(),h("div",Z,[s(o,{class:"custom-chip1 font-weight-light equal-width-chip",text:l.courseData.duration,label:""},null,8,["text"]),s(o,{style:{"background-color":"#FFE68E"},class:"custom-chip2 font-weight-light equal-width-chip mx-1",label:"",color:"#333132"},{default:u(()=>[w(m(l.courseData.lessons)+" уроков ",1)]),_:1})])):(a(),h("div",ee,[s(o,{class:"custom-chip1 font-weight-light my-1",text:l.courseData.duration,label:""},null,8,["text"]),s(o,{style:{"background-color":"#FFE68E"},class:"custom-chip2 font-weight-light my-1 ml-2",label:"",color:"#333132"},{default:u(()=>[w(m(l.courseData.lessons)+" уроков ",1)]),_:1})]))],2)]),_:1},8,["class"])}}}),se=U(te,[["__scopeId","data-v-fabdc2f5"]]),oe={class:"page-wrapper"},ae={class:"mt-5 font-weight-medium"},le={class:"action-buttons-container d-flex ga-3 mt-4 mb-5"},ne={key:0,class:"d-flex justify-center my-5"},re="https://t.me/babichbaker_course",ce=S({__name:"CourseBlocks",setup(l){const{mdAndDown:p}=T(),C=M(),f=O(),d=c(!1),o=c(""),_=c("Пекарская витрина: от Булок до Хлеба"),v=c([]),x=c(null),r=c(""),V=c(""),$=async e=>{if(e){d.value=!0,o.value="";try{const t=await W.fetchCourseWithBlocks(e);_.value=t.courseTitle||"Курс без названия",v.value=t.blocks||[],r.value=t.chat,t.imageUrl&&(V.value=A(t.imageUrl))}catch(t){console.error("Ошибка при загрузке курса:",t),o.value="Не удалось загрузить данные курса. Пожалуйста, попробуйте позже.",v.value=[]}finally{d.value=!1}}},A=e=>{if(!e)return"/public/default-lesson.jpg";let t=e.replace(/https:\/\/https:\/\//g,"https://");return t=t.replace(/https:\/\/https\//g,"https://"),t},j=(e,t)=>({id:e.blockId,number:t.toString(),title:e.blockTitle,imagePath:A(e.imageUrl),progress:{completed:e.completedLessons,total:e.lessonsCount},duration:`${e.lessonsCount*2.5} минут`,lessons:e.lessonsCount}),E=()=>{const t=r&&r.value&&typeof r.value=="string"&&r.value.trim()!==""&&!r.value.includes("null")?r.value:re;window.open(t,"_blank")},I=(e,t)=>{if(e){const y=Array.isArray(e)?e[0]:e;C.push(`/course/${y}/blocks/${t}`)}};return P(()=>f.params.courseId,e=>{e&&e!==x.value&&(x.value=e,$(e))}),z(()=>{const e=f.params.courseId;e&&(x.value=e,$(e))}),(e,t)=>{const y=i("v-btn"),N=i("v-progress-circular"),B=i("v-alert"),F=i("v-container");return a(),h("div",oe,[s(G),s(F,{class:"lesson-container pr-0",width:b(p)?"100vw":"60vw"},{default:u(()=>[n("h2",ae,m(_.value),1),t[1]||(t[1]=n("h3",{class:"mb-2 font-weight-regular"},"Авторский курс от Максима Бабича",-1)),n("div",le,[s(y,{class:"text-none secondary-action-btn",variant:"outlined",color:"#313131",text:"Назад",to:"/profile"}),s(y,{class:"text-none primary-action-btn",variant:"outlined",color:"#F48A21",text:"Чат курса","prepend-icon":"mdi-forum",onClick:E})]),d.value?(a(),h("div",ne,[s(N,{color:"#F48A21",indeterminate:""})])):k("",!0),o.value?(a(),g(B,{key:1,type:"error",class:"my-3"},{default:u(()=>[w(m(o.value),1)]),_:1})):k("",!0),!d.value&&!o.value?(a(),g(F,{key:2,class:"d-flex flex-column ga-7 ml-0 pl-0 align-center"},{default:u(()=>[(a(!0),h(R,null,H(v.value,(D,q)=>(a(),g(se,{key:D.blockId,"course-data":j(D,q+1),onClick:ie=>I(x.value,D.blockId)},null,8,["course-data","onClick"]))),128)),v.value.length===0?(a(),g(B,{key:0,type:"info",class:"my-3"},{default:u(()=>t[0]||(t[0]=[w(" Для этого курса еще не добавлены блоки ")])),_:1})):k("",!0)]),_:1})):k("",!0)]),_:1},8,["width"]),s(J)])}}}),fe=U(ce,[["__scopeId","data-v-4d77a1b6"]]);export{fe as default};
