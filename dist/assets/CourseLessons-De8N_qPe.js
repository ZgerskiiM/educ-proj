import{H as z,A as J}from"./AppFooter-D_dR9Fo7.js";import{d as O,u as U,c as y,m as p,o as i,i as F,w as f,e as a,f as c,t as r,b as g,n as B,j as K,h as x,_ as V,r as t,p as I,E as Q,g as P,F as X,y as Y,q as Z,l as ee}from"./index-BQEJhV1Z.js";import{c as R}from"./courseUserService-Dn6m0K-9.js";const se={class:"pa-4"},te={class:"card-text d-flex flex-wrap"},oe={class:"font-weight-bold mr-1"},ae={class:"font-weight-light"},re=O({__name:"LessonCard",props:{courseData:{type:Object,required:!0}},emits:["click"],setup(n){const{mdAndDown:v}=U(),o=n,C=y(()=>{switch(o.courseData.progress){case"IN_PROGRESS":return"В процессе";case"COMPLETED":return"Завершено";default:return"Не начато"}}),l=y(()=>{switch(o.courseData.progress){case"IN_PROGRESS":return"progress-in-progress";case"COMPLETED":return"progress-completed";default:return"progress-not-started"}});return(h,m)=>{const k=p("v-img"),D=p("v-card");return i(),F(D,{onClick:m[0]||(m[0]=S=>h.$emit("click",n.courseData.id)),class:"course-lessons rounded-lg",width:x(v)?"50vw":"20vw",elevation:"1"},{default:f(()=>[a(k,{src:n.courseData.imagePath,class:"responsive-image rounded-t","aspect-ratio":16/9,cover:""},null,8,["src"]),c("div",se,[c("div",te,[c("span",oe,r(n.courseData.number)+" /",1),c("span",ae,r(n.courseData.title),1)]),n.courseData.progress?(i(),g("div",{key:0,class:B(["progress-badge mt-2",l.value])},r(C.value),3)):K("",!0)])]),_:1},8,["width"])}}}),ce=V(re,[["__scopeId","data-v-134f4a4d"]]),ne={class:"page-wrapper"},le={class:"info"},ue={class:"mt-5 font-weight-medium"},ie={class:"mb-2 font-weight-regular"},de={class:"back-button-container pt-4 pb-2 pl-0 ml-0"},pe={key:0,class:"text-center w-100"},ve={key:1,class:"text-center w-100 red--text"},me=O({__name:"CourseLessons",setup(n){const{mdAndDown:v}=U(),o=Z(),C=ee(),l=y(()=>o.params.courseId),h=y(()=>o.params.blocksId),m=t(""),k=t([]),D=t("Авторский курс от Максима Бабича"),S=t("1"),T=t(""),u=t(!0),d=t(""),L=t([]),E=t("");I(()=>{const e=localStorage.getItem(`original_course_image_${l.value}`);e&&(E.value=e),N()});const N=async()=>{u.value=!0,d.value="";try{const e=await Q(h.value);T.value=e.blockTitle,L.value=e.lessons;const s=localStorage.getItem(`original_course_image_${l.value}`);s&&(E.value=s)}catch(e){d.value="Не удалось загрузить данные уроков",console.error(e)}finally{u.value=!1}},j=t(""),M=e=>{if(!e)return"/assets/default-lesson.jpg";let s=e.replace(/https:\/\/https:\/\//g,"https://");return s=s.replace(/https:\/\/https\//g,"https://"),s},q=async(e,s)=>{if(e){u.value=!0;try{const w=(await R.fetchCourseWithBlocks(e)).blocks.find($=>$.blockId===s);w&&(j.value=M(w.imageUrl))}catch(b){console.error("Ошибка при загрузке данных:",b)}finally{u.value=!1}}};I(()=>{const e=o.params.courseId,s=o.params.blockId;e&&s&&q(e,s)});const G=async e=>{if(e){u.value=!0,d.value="";try{const s=await R.fetchCourseWithBlocks(e);m.value=s.courseTitle||"Курс без названия",k.value=s.blocks||[]}catch(s){console.error("Ошибка при загрузке курса:",s),d.value="Не удалось загрузить данные курса. Пожалуйста, попробуйте позже.",k.value=[]}finally{u.value=!1}}};I(()=>{const e=o.params.courseId;e&&(l.value=e,G(e))});const H=e=>{C.push(`/course/${l.value}/blocks/${h.value}/lessons/${e}`)};return I(()=>{N()}),(e,s)=>{const b=p("v-btn"),w=p("v-card-title"),$=p("v-progress-circular"),A=p("v-container");return i(),g("div",ne,[a(z),a(A,{class:B(x(v)?"lessons-container":"lessons-container pl-0 pr-0"),width:x(v)?"100vw":"60vw"},{default:f(()=>[c("div",le,[c("h2",ue,r(m.value),1),c("h3",ie,r(D.value),1)]),c("div",de,[a(b,{variant:"outlined",density:"comfortable",to:`/course/${l.value}`,class:"back-button font-weight-light text-none"},{default:f(()=>s[0]||(s[0]=[P(" К блокам ")])),_:1},8,["to"])]),a(w,{class:"course-title font-weight-bold pt-0 pl-0",style:{color:"#333132"}},{default:f(()=>[P(" Блок "+r(S.value)+" / "+r(T.value),1)]),_:1}),a(A,{class:B(x(v)?"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 mr-0 pr-0":"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 align-center")},{default:f(()=>[u.value?(i(),g("div",pe,[a($,{indeterminate:"",color:"#F48A21"})])):d.value?(i(),g("div",ve,r(d.value),1)):(i(!0),g(X,{key:2},Y(L.value,(_,W)=>(i(),F(ce,{key:_.lessonId,"course-data":{id:_.lessonId,number:String(W+1).padStart(2,"0"),title:_.lessonTitle,imagePath:_.imageUrl},onClick:_e=>H(_.lessonId)},null,8,["course-data","onClick"]))),128))]),_:1},8,["class"])]),_:1},8,["class","width"]),a(J)])}}}),ke=V(me,[["__scopeId","data-v-b1e6dbee"]]);export{ke as default};
