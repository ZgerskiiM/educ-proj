import{d as j,u as I,m as u,o as n,i as y,w as o,e as s,f as d,n as D,h as b,t as c,g as a,b as f,_ as S,r as h,p as M,x as R,j as x,F as z,y as O,l as W,q as G}from"./index-B-l8DU2W.js";import{H as J}from"./Header-BQTW15nZ.js";import{c as K}from"./courseUserService-D9hS-sdo.js";/* empty css                                                                  */const Q={class:"d-flex align-center justify-space-between"},X={class:"text-h6"},Y={class:"font-weight-bold"},Z={class:"font-weight-light"},ee={key:0,class:"chip d-flex flex-wrap gap-2 mt-2"},te={key:1,class:"chip-container w-100 mt-2"},se=j({__name:"CourseCard",props:{courseData:{type:Object,required:!0,default:()=>({id:0,number:"1",title:"Загрузка...",imagePath:"/public/placeholder.jpg",progress:{completed:0,total:0},duration:"0 часов",lessons:0,cards:0})}},emits:["click"],setup(l){const{smAndDown:m}=I();return(w,r)=>{const g=u("v-img"),p=u("v-icon"),i=u("v-chip"),_=u("v-card");return n(),y(_,{onClick:r[0]||(r[0]=k=>w.$emit("click",l.courseData.id)),class:D(b(m)?"course-block-card d-flex flex-column rounded-sm":"rounded-lg	 course-block-card d-flex align-center"),width:"100%",flat:"",elevation:"1"},{default:o(()=>[s(g,{src:l.courseData.imagePath,class:"responsive-image rounded-t","aspect-ratio":16/9,cover:""},null,8,["src"]),d("div",{class:D(b(m)?"card-text px-2 py-3 flex-grow-1":"card-text ml-10 flex-grow-1")},[d("div",Q,[d("div",X,[d("span",Y,"Блок "+c(l.courseData.number)+" / ",1),d("span",Z,c(l.courseData.title),1)]),d("div",{class:D(b(m)?"font-weight-light grey--text progress-small":"font-weight-light mt-8 mr-10 grey--text")},[a(" Пройдено "+c(l.courseData.progress.completed)+"/"+c(l.courseData.progress.total)+" ",1),s(p,{small:""},{default:o(()=>r[1]||(r[1]=[a("mdi-chevron-right")])),_:1})],2)]),b(m)?(n(),f("div",te,[s(i,{class:"custom-chip1 equal-width-chip",text:l.courseData.duration,label:""},null,8,["text"]),s(i,{style:{"background-color":"#FFE68E"},class:"custom-chip2 equal-width-chip mx-1",label:"",color:"#333132"},{default:o(()=>[a(c(l.courseData.lessons)+" уроков ",1)]),_:1}),s(i,{style:{"background-color":"#FEE99E",color:"#333132"},class:"custom-chip3 equal-width-chip",label:""},{default:o(()=>[a(c(l.courseData.cards)+" технологических ",1),r[2]||(r[2]=d("br",null,null,-1)),r[3]||(r[3]=a(" карт "))]),_:1})])):(n(),f("div",ee,[s(i,{class:"custom-chip1 my-1",text:l.courseData.duration,label:""},null,8,["text"]),s(i,{style:{"background-color":"#FFE68E"},class:"custom-chip2 my-1 ml-2",label:"",color:"#333132"},{default:o(()=>[a(c(l.courseData.lessons)+" уроков ",1)]),_:1}),s(i,{style:{"background-color":"#FEE99E",color:"#333132"},class:"custom-chip3 my-1 ml-2",label:""},{default:o(()=>[a(c(l.courseData.cards)+" технологических карт ",1)]),_:1})]))],2)]),_:1},8,["class"])}}}),oe=S(se,[["__scopeId","data-v-3059ecc7"]]),ae={class:"page-wrapper"},le={class:"mt-5 font-weight-medium"},ne={key:0,class:"breadcrumbs-container"},re={key:1,class:"back-button-container pt-4 pb-2 pl-0 ml-0"},ce={key:2,class:"d-flex justify-center my-5"},ue="https://t.me/babichbaker_course",ie=j({__name:"CourseBlocks",setup(l){const{mdAndDown:m}=I(),w=W(),r=G(),g=h(!1),p=h(""),i=h("Пекарская витрина: от Булок до Хлеба"),_=h([]),k=h(null),v=h(""),$=async t=>{if(t){g.value=!0,p.value="";try{const e=await K.fetchCourseWithBlocks(t);i.value=e.courseTitle||"Курс без названия",_.value=e.blocks||[],v.value=e.chat}catch(e){console.error("Ошибка при загрузке курса:",e),p.value="Не удалось загрузить данные курса. Пожалуйста, попробуйте позже.",_.value=[]}finally{g.value=!1}}},T=t=>{if(!t)return"/public/default-lesson.jpg";let e=t.replace(/https:\/\/https:\/\//g,"https://");return e=e.replace(/https:\/\/https\//g,"https://"),e},V=(t,e)=>({id:t.blockId,number:e.toString(),title:t.blockTitle,imagePath:T(t.imageUrl),progress:{completed:t.completedLessons,total:t.lessonsCount},duration:`${t.lessonsCount*2.5} минут`,lessons:t.lessonsCount,cards:Math.round(t.lessonsCount)}),q=()=>{const e=v&&v.value&&typeof v.value=="string"&&v.value.trim()!==""&&!v.value.includes("null")?v.value:ue;window.open(e,"_blank")},A=(t,e)=>{w.push(`/course/${t}/blocks/${e}`)};return M(()=>{const t=r.params.courseId;t&&(k.value=t,$(t))}),R(()=>r.params.courseId,t=>{t&&t!==k.value&&(k.value=t,$(t))}),(t,e)=>{const N=u("v-icon"),E=u("v-btn"),F=u("v-breadcrumbs-item"),U=u("v-breadcrumbs"),P=u("v-progress-circular"),B=u("v-alert"),L=u("v-container");return n(),f("div",ae,[s(J),s(L,{width:b(m)?"100vw":"80vw"},{default:o(()=>[d("h2",le,c(i.value),1),e[5]||(e[5]=d("h3",{class:"mb-2 font-weight-regular"},"Авторский курс от Максима Бабича",-1)),s(E,{class:"font-weight-regular text-none",variant:"outlined",color:"#313131",onClick:q},{default:o(()=>[s(N,null,{default:o(()=>e[0]||(e[0]=[a("mdi-pencil")])),_:1}),e[1]||(e[1]=a(" Чат курса "))]),_:1}),b(m)?(n(),f("div",re,[s(E,{variant:"outlined",density:"comfortable",to:"/lk",class:"back-button text-none"},{default:o(()=>e[3]||(e[3]=[a(" В профиль ")])),_:1})])):(n(),f("div",ne,[s(U,{class:"mb-1 pl-0 font-weight-regular",color:"#F48A21"},{default:o(()=>[s(F,{to:"/lk"},{default:o(()=>e[2]||(e[2]=[a("Профиль")])),_:1}),s(F,{disabled:"",to:"/course"},{default:o(()=>[a(c(i.value),1)]),_:1})]),_:1})])),g.value?(n(),f("div",ce,[s(P,{indeterminate:"",color:"#F48A21"})])):x("",!0),p.value?(n(),y(B,{key:3,type:"error",class:"my-3"},{default:o(()=>[a(c(p.value),1)]),_:1})):x("",!0),!g.value&&!p.value?(n(),y(L,{key:4,class:"d-flex flex-column ga-7 ml-0 pl-0 align-center"},{default:o(()=>[(n(!0),f(z,null,O(_.value,(C,H)=>(n(),y(oe,{key:C.blockId,"course-data":V(C,H+1),onClick:de=>A(k.value,C.blockId)},null,8,["course-data","onClick"]))),128)),_.value.length===0?(n(),y(B,{key:0,type:"info",class:"my-3"},{default:o(()=>e[4]||(e[4]=[a(" Для этого курса еще не добавлены блоки ")])),_:1})):x("",!0)]),_:1})):x("",!0)]),_:1},8,["width"])])}}}),ge=S(ie,[["__scopeId","data-v-4de9e895"]]);export{ge as default};
