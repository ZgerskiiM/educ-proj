import{H,A as z}from"./AppFooter-BfDJsup2.js";import{d as E,u as A,c as y,m as n,o as c,i as N,w as r,e as s,f as d,t as o,b as i,n as P,j as W,h as x,_ as R,r as a,p as B,g as b,F as J,y as K,q as Q,l as X,E as Y}from"./index-DVyF8z1k.js";import{c as Z}from"./courseUserService-DRg3sHLg.js";const ee={class:"pa-4"},te={class:"card-text d-flex flex-wrap"},se={class:"font-weight-bold mr-1"},oe={class:"font-weight-light"},ae=E({__name:"LessonCard",props:{courseData:{type:Object,required:!0}},emits:["click"],setup(l){const{mdAndDown:g}=A(),p=l,C=y(()=>{switch(p.courseData.progress){case"IN_PROGRESS":return"В процессе";case"COMPLETED":return"Завершено";default:return"Не начато"}}),u=y(()=>{switch(p.courseData.progress){case"IN_PROGRESS":return"progress-in-progress";case"COMPLETED":return"progress-completed";default:return"progress-not-started"}});return(k,v)=>{const w=n("v-img"),D=n("v-card");return c(),N(D,{onClick:v[0]||(v[0]=I=>k.$emit("click",l.courseData.id)),class:"course-lessons rounded-lg",width:x(g)?"50vw":"14vw",elevation:"1"},{default:r(()=>[s(w,{src:l.courseData.imagePath,class:"responsive-image rounded-t","aspect-ratio":16/9,cover:""},null,8,["src"]),d("div",ee,[d("div",te,[d("span",se,o(l.courseData.number)+" /",1),d("span",oe,o(l.courseData.title),1)]),l.courseData.progress?(c(),i("div",{key:0,class:P(["progress-badge mt-2",u.value])},o(C.value),3)):W("",!0)])]),_:1},8,["width"])}}}),re=R(ae,[["__scopeId","data-v-cfe78874"]]),ce={class:"page-wrapper"},ne={class:"info"},le={class:"mt-5 font-weight-medium"},ue={class:"mb-2 font-weight-regular"},ie={key:0,class:"breadcrumbs-container"},de={key:1,class:"back-button-container pt-4 pb-2 pl-0 ml-0"},pe={key:0,class:"text-center w-100"},ve={key:1,class:"text-center w-100 red--text"},me=E({__name:"CourseLessons",setup(l){const{mdAndDown:g}=A(),p=Q(),C=X(),u=y(()=>p.params.courseId),k=y(()=>p.params.blocksId);a();const v=a(""),w=a([]),D=a("Авторский курс от Максима Бабича"),I=a("1"),$=a(""),h=a(!0),m=a(""),T=a([]),L=e=>{if(!e)return"/public/default-lesson.jpg";let t=e.replace(/https:\/\/https:\/\//g,"https://");return t=t.replace(/https:\/\/https\//g,"https://"),t},F=async e=>{if(e){h.value=!0,m.value="";try{const t=await Z.fetchCourseWithBlocks(e);v.value=t.courseTitle||"Курс без названия",w.value=t.blocks||[]}catch(t){console.error("Ошибка при загрузке курса:",t),m.value="Не удалось загрузить данные курса. Пожалуйста, попробуйте позже.",w.value=[]}finally{h.value=!1}}};B(()=>{const e=p.params.courseId;e&&(u.value=e,F(e))});const O=async()=>{h.value=!0,m.value="";try{const e=await Y(k.value);$.value=e.blockTitle,T.value=e.lessons}catch(e){m.value="Не удалось загрузить данные уроков",console.error(e)}finally{h.value=!1}},U=(e,t)=>{if(t){const _=L(t);console.log(`Сохраняем изображение урока ${e}:`,_),localStorage.setItem(`lesson_image_${e}`,_)}C.push(`/course/${u.value}/blocks/${k.value}/lessons/${e}`)};return B(()=>{O()}),(e,t)=>{const _=n("v-breadcrumbs-item"),V=n("v-breadcrumbs"),j=n("v-btn"),M=n("v-card-title"),q=n("v-progress-circular"),S=n("v-container");return c(),i("div",ce,[s(H),s(S,{width:x(g)?"100vw":"60vw"},{default:r(()=>[d("div",ne,[d("h2",le,o(v.value),1),d("h3",ue,o(D.value),1)]),x(g)?(c(),i("div",de,[s(j,{variant:"outlined",density:"comfortable",to:`/course/${u.value}`,class:"back-button text-none"},{default:r(()=>t[1]||(t[1]=[b(" К блокам ")])),_:1},8,["to"])])):(c(),i("div",ie,[s(V,{class:"mb-1 pl-0 font-weight-light",color:"#F48A21"},{default:r(()=>[s(_,{to:"/lk"},{default:r(()=>t[0]||(t[0]=[b("Профиль")])),_:1}),s(_,{to:`/course/${u.value}`},{default:r(()=>[b(o(v.value),1)]),_:1},8,["to"]),s(_,{disabled:"",to:`/course/${u.value}/blocks`},{default:r(()=>[b(o($.value),1)]),_:1},8,["to"])]),_:1})])),s(M,{class:"course-title font-weight-bold pt-0 pl-0",style:{color:"#333132"}},{default:r(()=>[b(" Блок "+o(I.value)+" / "+o($.value),1)]),_:1}),s(S,{class:P(x(g)?"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 mr-0 pr-0":"d-flex flex-row flex-wrap ga-5 ml-0 pl-0 align-center")},{default:r(()=>[h.value?(c(),i("div",pe,[s(q,{indeterminate:"",color:"#F48A21"})])):m.value?(c(),i("div",ve,o(m.value),1)):(c(!0),i(J,{key:2},K(T.value,(f,G)=>(c(),N(re,{key:f.lessonId,"course-data":{id:f.lessonId,number:String(G+1).padStart(2,"0"),title:f.lessonTitle,imagePath:L(f.imageUrl)},onClick:_e=>U(f.lessonId,f.imageUrl)},null,8,["course-data","onClick"]))),128))]),_:1},8,["class"])]),_:1},8,["width"]),s(z)])}}}),be=R(me,[["__scopeId","data-v-f8e297c7"]]);export{be as default};
